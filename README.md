# Personal-Address-Book-Management-System
个人通讯录管理系统/基于.NET+SQLserver/大学.NET程序设计课程设计
一、	需求分析
1.	概述
本需求规约从用户对软件的需求出发,系统分析软件的功能以及实现过程所需要做的所有工作。主要定义了手机通讯录管理工具的需求，由五大模块组成，具体功能分为:查询联系人:增刺改联系人;导入/导出联系人，发送联系人信息:设置等。
2.	基本功能
本手机通讯录工具主要实现五大功能:联系人的查询:字段查询，分组查询，字母排序查询;增加、删除联系人以及修改联系人信息;导入、导出联系人;发送联系人信息;设置。
3.	具体需求分析
(1)	分组管理用例
基木流:点击联系人列表视图中的分组键进入进入分组视图;点击分组视图中的添加键添加分组,或者点击分组后的删除键删除分组;点击分组后的添加键向分组中添加联系人，或者点击分组中联系人后的删除键删除联系人。
备选流:增加分组时，存储空间不够时提示用户并返回。3.2发送联系人用例
基本流:用户打开功能界面，功能界面为发送联系人信息用例提供入口;用户选择“发送联系人信息”功能项，页面直接跳转到通讯录列表;用户进入通讯录列表，选择需要发送的一个或者多个联系人并按确认选项;用户进入“正在发送”等待界面，若发送完毕且发送成功则显示“己发送成功”。反之，则显示“对不起，发送联系人信息失败”;发送联系人信息完毕回到通讯录主界面。
备选流:若手机无信号或者无 sim卡，则用户在基本流⒉操作后显示“找不到可用网络”界面，然后返回主界面。
(2)	查询联系人用例
基本流:用户打开功能界面，功能界面为查询用例提供入口;用户选择“通讯录”功能项，页面直接跳转到通讯录首页;进入通讯录的缺省页面为联系人列表，在列表中看到所有联系人的姓名、电话等基本信息和查询方式选择键以及相应的信息输入框;用户选择一种查询方式，输入联系人基本信息，通讯录显示所有符合查询条件的联系人列表;用户选择一联系人进入联系人基本信息页面进行其他操作;查询完成，用户按退格键返回主界面。
备选流:通过分组查询:用户在基本流第3步可以选择进入分组列表，选择特定的组，然后再进行基本流第4、5步进行查询;查询信息不存在:用户在基本流第4步查询信息不存在，通讯录提醒用户“查询失败”，用户返回主界面，用例结束;通讯录损坏:若通讯录损坏，则会在基本流第3步提示“通讯录己损坏”，然后结束用例。
(3)	增、删、改联系人用例
基木流:点击通信录中的增加按钮，进入增加联系人界面。输入联系人的基木信息，并可根据用户需求增加个性化信息,单击确认返回主页面;点击通信录中一个己存在的联系人，进入联系人编辑界面。可修改联系人的资料或进行删除联系人操作，完成后进入主页面。
备选流:点击通信录中的增加按钮时若存储卡空间不足，则提示错误并返回。对联系人中的每条信息都可进行隐藏设置;在修改或删除联系人的过程中，系统将提示用户是否确认操作，若放弃操作，则联系人信息恢复至修改前。
(4)	通讯录设置
基本流:用户根据自己的偏好设置字体、颜色等信息。3.6导入、导出通讯录
基本流:用户点击菜单进入导入导出界面，点击导出手机通信录出现文件系统选择保存路径，选择并且点击导出后在指定目录生成包含通信录信息的Excel文件，显示“通信录导出成功”并且返回至导入导出界而。点击导入手机通信录出现文件系统选择需要导入的Excel文件，选中文件点击导入后将信息添加至手机通信录，显示导入成功并返回导入导出界面。
备选流:点击进入导入导出界面，点击返回则返回软件主界面。导出文件时存储卡空间不足，则提示错误并返回导出界面。导入文件时打开无法识别的文件提示错误，返回导入文件界面。
本需求规约从用户对软件的需求出发,系统分析软件的功能以及实现过程所需要做的所有工作。主要定义了手机通讯录管理工具的需求，由五大模块组成，具体功能分为:查询联系人:增刺改联系人;导入/导出联系人，发送联系人信息:设置等。
4.	功能模块分析
系统采用“自顶向下，逐步求精“的分析与设计方法来完成各功能模块的设计。系统功能模块图如下图所示。
理
 
个人通讯录管理系统功能模块图








二、	详细设计
1.	数据库设计
数据库是网上图书销售系统的重要组成部分。系统中所有的数据，数据间的关系都存储在数据库当中。这样以便于后台对数据的新增、修改、删除查询等各项操作。本系统采用SQLserver数据库，数据库的名字为address，数据库中有多张数据表，每个数据表中都有大量的数据，每一行代表着一条记录，每一列代表着一个字段。
2.	数据库实体图
（1）图书及其属性：
 

通讯记录实体图
（2）用户及其属性
 

用户实体图

3.	数据库表设计
(1)	通讯记录表
通讯记录设计如表所示。通讯记录表描述了关于本系统内所有的通讯记录信息。

通讯记录表
列名	数据类型	约束
姓名	varchar(13)	主码 非空约束
移动手机	varchar(40)	主码 检查约束
Emali	varchar(20)	无
扣扣	varchar(8)	无
单位	varchar(30)	  无  
固定电话	varchar(30)	无
类别	varchar(4)	非空约束

（2）用户表
     用户表设计如表所示，用户表描述了本系统内所有的用户登录信息。
用户表
列名	数据类型	约束
账户 	varchar(10)	主码
密码 	varchar(18)	主码




















三、	项目实现
1.	数据库连接
(1)	为了简化代码,将对数据库操作写成一个类,用的时候初始化对象,调用方法即可。
(2)	using System.Data.SqlClient用于导入数据库连接的类。
(3)	SqlConnection类方法有open（）用于打开sqlserver数据库；close（）用于关闭数据库。
(4)	SqlCommand类方法有ExecuteNonQuery（）用于插入、修改、删除等更新操作语句；ExecuteReader（）用于查找语句。
(5)	可以在数据库连接类里定义连接方法、更新方法、读取方法、关闭方法。
(6)	使用时可以先初始化数据库类对象，直接使用该对象相应方法。
2.	登入界面
(1)	登入验证
1)	输入信息合法检查
先获取用户登入账号和密码，判定其字符串是否为空，如果是则弹出相应信息不能为空。
2)	用户密码合法检查
在上面的基础上，连接上数据库，通过sql的select语句，调用数据库类对象的读取方法查找用户账号对应的密码是否存在。若不存在弹出错误信息“用户名或密码错误。”
(2)	向用户首页传用户名并跳
在上面基础上，如果存在密码，新窗口打开用户首页（LinkForm）并传入之前获取的用户名参数。
(3)	向注册页面跳转
直接在注册链接文本上新窗口打开注册首页。
(4)	界面设计如下
 
3.	注册页面
(1)	注册验证
1)	输入信息合法检查
先获取用户登入账号和密码，判定其字符串是否为空，如果是则弹出相应信息不能为空。如果通过用户合法检查，在判断两次密码是否一致，若不一致弹出提示“两次输入的密码不同，请重新输入”。
2)	用户账户合法检查
在上面基础上先通过sql的select语句，调用数据库类对象的读取方法查找用户账号是否存在，如果已存在，直接弹出“用户名已存在，请重新输入用户名”信息，如果不存在则通过sql的insert语句，调用数据库类对象的更新方法,将用户注册信息存储在数据库。
(2)	跳转到登入界面
通过注册验证后，新窗口打开登入界面。
(3)	界面设计如下
 
4.	用户首页
(1)	显示用户名并退出
1)	显示用户
将登入界面传来的用户名参数获取并追加给欢迎文本控件。
2)	退出
退出按钮处理事件上新窗口打开登入界面。
(2)	显示时间
直接使用datetime类的now方法进行格式化输出。再将输出的结果给控件文本追加。
(3)	数据显示并分页
先清除原本的记录，建立数据库连接，使用sql的select语句，再使用数据库对象的读取方法对数据库读取。如果可以读到，每条数据就添加到dataGridView1中去。
(4)	查询联系人
1)	指定查找
先获取下拉选框的文本信息，如果是非模糊查找，就调用相应方法。某个方法都是先初始化数据库对象，使用sql的select语句，再使用数据库对象的读取方法对数据库读取。如果可以读到，每条数据就添加到dataGridView1中去。如果没有找到，弹出信息“没有找到”。最后关闭读取流，数据库流。
2)	模糊查找
和上面一样，只不过sql的select语句里用到like语句。
(5)	添加联系人
1)	新窗口打开添加联系人界面。
2)	先获取添加联系人界面的姓名、单位、固定电话、移动手机、电子邮箱、扣扣、分类信息。
3)	检查输入合法
如果姓名、移动手机号为空，弹出相应信息不能为空。如果不为空，再检查手机号是否是11位。
4)	检查用户名是否已存在
先初始化数据库对象，使用sql的select语句，再使用数据库对象的读取方法对数据库读取。如果找到，弹出“用户名已存在，请重新输入用户名”信息。若找不到，使用sql的insert语句，再使用数据库对象的更新方法将添加信息存储到数据库中。
(6)	修改联系人
1)	先获取通过首页窗口传过来的的姓名、单位、固定电话、移动手机、电子邮箱、扣扣、分类信息。
2)	将修改联系人界面的控件添加获取的相应信息
3)	最后使用sql的insert语句，再使用数据库对象的更新方法对修改的数据进行存储到数据库中。
(7)	删除联系人
1)	先获取高光显示的dataGridView1控件的手机号字段。
2)	提示弹出“确认删除?", "信息提示”信息。
3)	初始化数据库对象，使用sql的insert语句，再使用数据库对象的更新方法对高光显示的信息删除。如果成功提示“删除成功”，失败提示“删除失败”。
(8)	界面设计如下
 































四、	运行结果、测试与分析
1.	注册功能测试：
(1)	注册失败：
  

(2)	注册成功：
 
2.登录功能模块：
(1)	登录失败：
 
(2)	登录成功：
 

3.	查询功能模块：
(1)	查询功能------姓名
 
(2)	查询功能-------移动电话
 
(3)	查询功能-------单位
 
(4)	查询功能------模糊查询
 
(5)	查询功能--没有查到
 

4.	添加信息功能模块
(1)	添加成功：

 
(2)	添加失败-----手机号为空：
 


(3)	添加失败-----手机号不为11位：
 

(4)	添加失败-----姓名为空：
 



5.	修改信息功能模块：
 
6.	删除信息功能模块：
  

